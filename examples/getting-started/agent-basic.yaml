# Agent Demo Topology
#
# This is an INFRASTRUCTURE demo - it shows how to define topology, networking,
# and access control. The containers use Alpine with sleep commands as placeholders.
#
# Demonstrates:
# - MCP servers providing tools
# - Agents that connect to the gateway and use specific servers
# - Environment variable injection (MCP_ENDPOINT)
# - Tool access control via `uses` field
#
# For examples with real MCP server logic, see:
# - transports/local-mcp.yaml (stdio transport with actual MCP server)
# - transports/external-mcp.yaml (HTTP/SSE transport)
# - platforms/github-mcp.yaml (real third-party MCP server)
#
# Usage:
#   gridctl deploy examples/getting-started/agent-basic.yaml
#
version: "1"
name: agent-demo

network:
  name: agent-demo-net

mcp-servers:
  - name: tools-server
    image: alpine:latest
    port: 8080
    command: ["sh", "-c", "while true; do sleep 3600; done"]
    description: "Primary tools server"

  - name: secondary-server
    image: alpine:latest
    port: 8081
    command: ["sh", "-c", "while true; do sleep 3600; done"]
    description: "Secondary tools server (not accessible by demo-agent)"

agents:
  - name: demo-agent
    image: alpine:latest
    description: "Demo agent with access to tools-server only"
    capabilities:
      - tool-usage
      - automation
    uses:
      - tools-server
    env:
      AGENT_MODE: "demo"
    command: ["sh", "-c", "echo 'Agent started with MCP_ENDPOINT='$MCP_ENDPOINT && while true; do sleep 3600; done"]
