# A2A Protocol Demo Stack
#
# Demonstrates Agent-to-Agent (A2A) protocol features:
# - Local agents that expose A2A endpoints via the gateway
# - Skills advertisement and discovery
#
# Usage:
#   gridctl deploy examples/multi-agent/basic-a2a.yaml
#
# Testing:
#   # Check gateway status (includes unified agents with A2A info)
#   curl http://localhost:5555/api/status | jq
#
#   # Fetch the gateway's Agent Card
#   curl http://localhost:5555/.well-known/agent.json | jq
#
#   # Send a message to a local A2A agent
#   curl -X POST http://localhost:5555/a2a/code-assistant \
#     -H "Content-Type: application/json" \
#     -d '{
#       "jsonrpc": "2.0",
#       "id": "1",
#       "method": "message/send",
#       "params": {
#         "message": {
#           "role": "user",
#           "parts": [{"text": "Hello, can you help me write a function?"}]
#         }
#       }
#     }' | jq

version: "1"
name: a2a-demo

network:
  name: a2a-demo-net

# MCP servers providing tools to agents
mcp-servers:
  - name: code-tools
    image: alpine:latest
    port: 8080
    command: ["sh", "-c", "while true; do sleep 3600; done"]
    description: "Code analysis and generation tools"

# Container agents with A2A capabilities
agents:
  - name: code-assistant
    image: alpine:latest
    description: "AI coding assistant that can help with code review and generation"
    capabilities:
      - code-review
      - code-generation
    uses:
      - code-tools

    # A2A configuration - exposes this agent via A2A protocol
    a2a:
      enabled: true
      version: "1.0.0"
      skills:
        - id: code-review
          name: Code Review
          description: "Review code for bugs, security issues, and best practices"
        - id: code-generation
          name: Code Generation
          description: "Generate code based on natural language descriptions"
    command: ["sh", "-c", "echo 'Code assistant ready' && while true; do sleep 3600; done"]

  - name: docs-assistant
    image: alpine:latest
    description: "Documentation assistant for generating and updating docs"
    capabilities:
      - documentation

    # A2A configuration
    a2a:
      enabled: true
      version: "1.0.0"
      skills:
        - id: doc-generation
          name: Documentation Generation
          description: "Generate documentation from code or specifications"
        - id: doc-review
          name: Documentation Review
          description: "Review and improve existing documentation"
    command: ["sh", "-c", "echo 'Docs assistant ready' && while true; do sleep 3600; done"]

# External A2A agents (remote agents accessible via URL)
# Uncomment to connect to remote A2A agents running elsewhere:
#
# a2a-agents:
#   - name: remote-agent
#     url: http://example.com:9999
#     auth:
#       type: bearer
#       token_env: REMOTE_AGENT_TOKEN
